#!/usr/bin/env ruby

require 'puppet-parse'
require 'yaml'

abort 'puppet-parse: no arguments given ' if ARGV[0].nil?

runner = PuppetParse::Runner.new

path = ARGV[0]
if File.directory?(path)
  puppet_files = Dir.glob("#{path}/**/*.pp")
  puts runner.run(puppet_files.to_a).to_yaml
else
  puts runner.run(ARGV).to_yaml
end